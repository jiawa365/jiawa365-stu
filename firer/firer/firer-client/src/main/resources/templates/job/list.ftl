<!DOCTYPE html>
<html lang="en" style="" class=""><head>

    <!-- Title -->
    <title>Layers | Extra - Shop</title>
    <#assign ctx="${request.contextPath}">
	<#assign staticUrl="${request.contextPath}/">
	<base href="${staticUrl}">

    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta charset="UTF-8">
    <meta name="description" content="Admin Dashboard Template">
    <meta name="keywords" content="admin,dashboard">
    <meta name="author" content="Lalassu">

    <!-- Styles -->
    <link href="assets/plugins/pace-master/themes/blue/pace-theme-flash.css" rel="stylesheet">
    <link href="assets/plugins/uniform/css/default.css" rel="stylesheet">
    <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/fontawesome/css/font-awesome.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/line-icons/simple-line-icons.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/offcanvasmenueffects/css/menu_cornerbox.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/waves/waves.min.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/switchery/switchery.min.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/3d-bold-navigation/css/style.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/slidepushmenus/css/component.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/product-preview-slider/css/style.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/toastr/toastr.min.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/checkoutconcepts/css/checkout-cornerflat.css" rel="stylesheet" type="text/css">

    <!-- Theme Styles -->
    <link href="assets/css/custom.css" rel="stylesheet" type="text/css">

    <link href="assets/css/layers.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/layers/dark-layer.css" class="theme-color" rel="stylesheet" type="text/css"/>



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->



</head>
<body class="compact-menu  pace-done">



<div class="pace  pace-inactive"><div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);">
    <div class="pace-progress-inner"></div>
</div>
    <div class="pace-activity"></div></div>
<div class="overlay"></div>
<nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-right" id="cbp-spmenu-s1">
    <h3><span class="pull-left">Chat</span><a href="javascript:void(0);" class="pull-right" id="closeRight"><i class="icon-close"></i></a></h3>
    <div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 100%;"><div class="slimscroll" style="overflow: hidden; width: auto; height: 100%;">
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar2.png" alt=""><span>Michael Lewis<small>Nice to meet you</small></span></a>
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar3.png" alt=""><span>John Doe<small>Nice to meet you</small></span></a>
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar4.png" alt=""><span>Emma Green<small>Nice to meet you</small></span></a>
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar5.png" alt=""><span>Nick Doe<small>Nice to meet you</small></span></a>
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar2.png" alt=""><span>Michael Lewis<small>Nice to meet you</small></span></a>
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar3.png" alt=""><span>John Doe<small>Nice to meet you</small></span></a>
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar4.png" alt=""><span>Emma Green<small>Nice to meet you</small></span></a>
        <a href="javascript:void(0);" class="showRight2"><img src="assets/images/avatar5.png" alt=""><span>Nick Doe<small>Nice to meet you</small></span></a>
    </div><div class="slimScrollBar" style="background: rgb(204, 204, 204); width: 7px; position: absolute; top: 0px; opacity: 0.2; display: none; border-radius: 0px; z-index: 99; right: 1px; height: 958px;"></div><div class="slimScrollRail" style="width: 7px; height: 100%; position: absolute; top: 0px; display: none; border-radius: 0px; background: rgb(51, 51, 51); opacity: 0.3; z-index: 90; right: 1px;"></div></div>
</nav>
<nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-right" id="cbp-spmenu-s2">
    <h3><span class="pull-left">Michael Lewis</span> <a href="javascript:void(0);" class="pull-right" id="closeRight2"><i class="fa fa-angle-right"></i></a></h3>
    <div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 100%;"><div class="slimscroll chat" style="overflow: hidden; width: auto; height: 100%;">
        <div class="chat-item chat-item-left">
            <div class="chat-image">
                <img src="assets/images/avatar2.png" alt="">
            </div>
            <div class="chat-message">
                Duis aute irure dolor?
            </div>
        </div>
        <div class="chat-item chat-item-right">
            <div class="chat-message">
                Lorem ipsum dolor sit amet, dapibus quis, laoreet et.
            </div>
        </div>
        <div class="chat-item chat-item-left">
            <div class="chat-image">
                <img src="assets/images/avatar2.png" alt="">
            </div>
            <div class="chat-message">
                Ut ullamcorper, ligula.
            </div>
        </div>
        <div class="chat-item chat-item-right">
            <div class="chat-message">
                In hac habitasse platea dict umst. ligula eu tempor eu id tincidunt.
            </div>
        </div>
        <div class="chat-item chat-item-left">
            <div class="chat-image">
                <img src="assets/images/avatar2.png" alt="">
            </div>
            <div class="chat-message">
                Curabitur pretium?
            </div>
        </div>
        <div class="chat-item chat-item-right">
            <div class="chat-message">
                Etiam tempor. Ut tempor! ull amcorper.
            </div>
        </div>
    </div><div class="slimScrollBar" style="background: rgb(204, 204, 204); width: 7px; position: absolute; top: 0px; opacity: 0.2; display: none; border-radius: 0px; z-index: 99; right: 1px; height: 958px;"></div><div class="slimScrollRail" style="width: 7px; height: 100%; position: absolute; top: 0px; display: none; border-radius: 0px; background: rgb(51, 51, 51); opacity: 0.3; z-index: 90; right: 1px;"></div></div>
    <div class="chat-write">
        <form class="form-horizontal" action="javascript:void(0);">
            <input type="text" class="form-control" placeholder="Say something">
        </form>
    </div>
</nav>
<form class="search-form" action="#" method="GET">
    <div class="input-group">
        <input type="text" name="search" class="form-control search-input" placeholder="Type something...">
                <span class="input-group-btn">
                    <button class="btn btn-default close-search" type="button"><i class="icon-close"></i></button>
                </span>
    </div><!-- Input Group -->
</form><!-- Search Form -->
<main class="page-content content-wrap">
    <!-- Navbar -->
    <!-- Page Sidebar -->
    <div class="page-inner" style="min-height:1159px !important">
        <div class="page-title">
            <h3 class="breadcrumb-header">模块中心</h3>
            <div class="page-breadcrumb">
                <ol class="breadcrumb breadcrumb-with-header">
                    <li><a href="index.html">Home</a></li>
                </ol>
            </div>
        </div>
        <div id="main-wrapper">
            <div class="row">
                <div class="col-md-12">
                    <div class="btn-group">
                        <button type="button" class="btn btn-success" data-toggle="modal" data-target=".bs-example-modal-sm">添加</button>
                        <button type="button" class="btn btn-default">清空</button>
                    </div>

                    <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-sm">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="mySmallModalLabel">添加</h4>
                                </div>
                                <div class="modal-body">
                                    <div class='form-group'>
                                        <input type='text' class='form-control m-t-xxs' id='jobName' placeholder='任务名称'>
                                    </div>
                                    <div class='form-group'>
                                        <input type='text' class='form-control m-t-xxs' id='jobExpression' placeholder='corn表达式或具体时间'>
                                    </div>
                                    <div class='form-group'>
                                        <label for="">模块：</label>
                                        <select id='moduleId' class=''>
                                            <option value="-1">请选择</option>
                                        </select>
                                    </div>

                                    <div class='form-group'>
                                        <label for="">方法：</label>
                                        <select id='methodName' class=''>
                                            <option value="-1">请选择</option>
                                        </select>
                                    </div>

                                    <div class='form-group'>
                                        <input type='text' class='form-control m-t-xxs' id='params' placeholder='参数格式:name:"张三",age:"18"'>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                    <button type="button" class="btn btn-success" data-dismiss="modal" onclick="add()">保存</button>
                                </div>
                            </div>
                        </div>
                    </div>


                    <table class="table table-bordered ">
                        <thead>
                        <tr>
                            <th>任务名称</th>
                            <th>模块</th>
                            <th>方法</th>
                            <th>状态</th>
                            <th>开始时间</th>
                            <th>结束时间</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                          <tbody>
                            <#list jobs as job>
                                <tr>
                                    <td>${job.jobName!}</td>
                                    <td>${job.module.moduleName!}</td>
                                    <td>${job.methodName!}</td>
                                    <td>${job.statusStr!}</td>
                                    <td>${job.beginTime!}</td>
                                    <td>${job.endTime!}</td>
                                    <td>
                                        <a href="${ctx}/job/singleStart?jobId=${job.jobId}" class="btn btn-info">单次启动</a>
                                        <a href="${ctx}/job/changeStatus?jobId=${job.jobId}&status=0" class="btn btn-success">启动/恢复</a>
                                        <a href="${ctx}/job/changeStatus?jobId=${job.jobId}&status=4" class="btn btn-primary">暂停</a>
                                        <a href="${ctx}/job/changeStatus?jobId=${job.jobId}&status=3" class="btn btn-warning">停止</a>
                                        <a href="${ctx}/job/del?jobId=${job.jobId}" class="btn btn-danger">删除</a>
                                    </td>
                                </tr>
                            </#list>
                        </tbody>

                    </table>

                </div>
            </div><!-- Row -->
        </div><!-- Main Wrapper -->

    </div><!-- Page Inner -->
</main><!-- Page Content -->
<nav class="cd-nav-container" id="cd-nav">
    <header>
        <h3>LAYERS</h3>
    </header>
    <div class="col-md-6 demo-block demo-selected demo-active">
        <p>Dark<br>Design</p>
    </div>
    <div class="col-md-6 demo-block">
        <a href="../admin2/index.html"><p>Light<br>Design</p></a>
    </div>
    <div class="col-md-6 demo-block demo-coming-soon">
        <p>Horizontal<br>(Coming)</p>
    </div>
    <div class="col-md-6 demo-block demo-coming-soon">
        <p>Material<br>(Coming)</p>
    </div>
    <div class="col-md-6 demo-block demo-coming-soon">
        <p>Coming<br>Soon</p>
    </div>
    <div class="col-md-6 demo-block demo-coming-soon">
        <p>Coming<br>Soon</p>
    </div>
</nav>
<div class="cd-overlay"></div>


<!-- Javascripts -->
<script src="assets/plugins/jquery/jquery-3.1.0.min.js"></script>
<script src="assets/plugins/jquery-ui/jquery-ui.min.js"></script>
<script src="assets/plugins/pace-master/pace.min.js"></script>
<script src="assets/plugins/jquery-blockui/jquery.blockui.js"></script>
<script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script src="assets/plugins/switchery/switchery.min.js"></script>
<script src="assets/plugins/uniform/js/jquery.uniform.standalone.js"></script>
<script src="assets/plugins/offcanvasmenueffects/js/classie.js"></script>
<script src="assets/plugins/waves/waves.min.js"></script>
<script src="assets/plugins/3d-bold-navigation/js/main.js"></script>

<script>

    $(function(){
        //加载模块
        $.post('${ctx}/module/list',function(data){
            $(data).each(function(i,v){
                $('#moduleId').append("<option value='"+v.moduleId+"'>"+v.moduleName+"</option>");
            });

            //绑定模块change事件
            $('#moduleId').change(function(){
                $('#methodName').html('<option value="-1">请选择</option>');
                $.post('${ctx}/module/getMethods',{'moduleId':this.value},function(data){
                    data=eval("("+data+")");
                    if(data.success){
                        $(data.result).each(function(i,v){
                            $('#methodName').append("<option value='"+v.name+"'>"+v.name+"</option>");
                        });
                    }else{
                        alert(data.msg);
                    }
                });
            });
        });
    });

    function add(){
        var jobName= $('#jobName').val();
        var jobExpression= $('#jobExpression').val();
        var moduleId= $('#moduleId').val();
        var methodName= $('#methodName').val();
        var params= $('#params').val();

        $.post('${ctx}/job/add',{
            jobName:jobName,
            jobExpression:jobExpression,
            moduleId:moduleId,
            methodName:methodName,
            params:"{"+params+"}"
        },function(data){
            if(data.success){
                location.reload();
            }else{
                alert(data.msg);
            }
        });

        /*$.ajax({
            // 传递集合数据时headers必须添加，否则会报415错误
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            type: 'POST',
            dataType: "json", //表示返回值类型，不必须
            data:{
                jobName:jobName,
                jobExpression:jobExpression,
                moduleId:moduleId,
                methodName:methodName,
                params:[{'paramKey':1,paramValue:2},{'paramKey':1,paramValue:2}]
            },
            url: '${ctx}/job/add',
            success: function(){

            }

        });*/

    }

</script>



</body>


</html>